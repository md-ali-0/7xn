<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %> - Gmail Checker Auth</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <%- include('partials/header') %>
    
    <main class="main-content">
        <div class="container">
            <h1>Dashboard</h1>
            
            <div class="dashboard-grid">
                <!-- User Info Card -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Account Information</h2>
                    </div>
                    <p><strong>Username:</strong> <%= user.username %></p>
                    <p><strong>Email:</strong> <%= user.email %></p>
                    <p><strong>Role:</strong> <%= user.role.charAt(0).toUpperCase() + user.role.slice(1) %></p>
                    <p><strong>Account Status:</strong> 
                        <span class="<%= user.isActive ? 'text-success' : 'text-danger' %>">
                            <%= user.isActive ? 'Active' : 'Inactive' %>
                        </span>
                    </p>
                    <% if (user.lastLogin) { %>
                        <p><strong>Last Login:</strong> <%= user.lastLogin.toLocaleDateString() %></p>
                    <% } %>
                </div>
                
                <!-- Package Info Card -->
                <% if (user.package) { %>
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Package Details</h2>
                    </div>
                    <p><strong>Package:</strong> <%= user.package.name %></p>
                    <p><strong>Email Credits:</strong> <%= user.package.emailCredits.toLocaleString() %> per month</p>
                    <p><strong>Concurrency Limit:</strong> <%= user.package.concurrencyLimit %></p>
                    <p><strong>Package Start:</strong> <%= user.packageStartDate.toLocaleDateString() %></p>
                    <p><strong>Package End:</strong> <%= user.packageEndDate.toLocaleDateString() %></p>
                    <p><strong>Days Remaining:</strong> 
                        <span class="<%= daysUntilExpiry <= 7 ? 'text-danger' : daysUntilExpiry <= 30 ? 'text-warning' : 'text-success' %>">
                            <%= daysUntilExpiry %> days
                        </span>
                    </p>
                </div>
                
                <!-- Package Features Card -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Package Features</h2>
                    </div>
                    <ul>
                        <% user.package.features.forEach(feature => { %>
                            <li><%= feature %></li>
                        <% }) %>
                    </ul>
                </div>
                <% } else { %>
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Package Details</h2>
                    </div>
                    <p><strong>Status:</strong> No package assigned</p>
                    <p>As an admin user, you don't need a package to access system features.</p>
                </div>
                <% } %>
            </div>
            
            <!-- Admin Statistics -->
            <% if (user.role === 'admin' && stats) { %>
                <h2 class="mt-3">Admin Statistics</h2>
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-number"><%= stats.totalUsers %></div>
                        <div class="stat-label">Active Users</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #dc3545, #c82333);">
                        <div class="stat-number"><%= stats.expiredUsers %></div>
                        <div class="stat-label">Expired Users</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #ffc107, #e0a800);">
                        <div class="stat-number"><%= stats.expiringUsers %></div>
                        <div class="stat-label">Expiring Soon</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #28a745, #218838);">
                        <div class="stat-number"><%= stats.totalPackages %></div>
                        <div class="stat-label">Active Packages</div>
                    </div>
                </div>
                
                <div class="text-center mt-3">
                    <a href="/admin/users" class="btn btn-primary">Manage Users</a>
                </div>
            <% } %>
        </div>
    </main>
    
    <%- include('partials/footer') %>
    
    <script src="/js/main.js"></script>
</body>
</html>